/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { excelReportsGenerate } from "../../funcs/excelReportsGenerate.js";
import * as operations from "../../sdk/models/operations/index.js";
import { formatResult, ToolDefinition } from "../tools.js";

const args = {
  request: operations.GenerateExcelReportRequest$inboundSchema,
};

export const tool$excelReportsGenerate: ToolDefinition<typeof args> = {
  name: "excel-reports-generate",
  description: `Generate Excel report

The *Generate Excel report* endpoint requests the production of a downloadable Excel file for a report type specified in the \`reportType\` query parameter.

In response, the endpoint returns the [status](https://docs.codat.io/lending-api#/schemas/ExcelStatus) detailing the current state of the report generation request.

### Report types

| reportType                                                                           | Description                                                                                                                                   |
|--------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| \`audit\`                          | Identifies inaccurate or out-of-date accounts, helping you to make decisions with confidence.                                                   || [audit](https://docs.codat.io/lending/excel/audit-report)                            | Identify inaccurate or out-of-date accounts, helping you to make decisions with confidence.                                                   |
| \`enhancedCashFlow\`    | Provides a fully categorized list of bank transactions for a company, allowing lenders to accurately forecast a company's cash flow.  |
| \`enhancedFinancials\` | Supports decision-making using fully categorized financial statements to allow lenders to automate their underwriting processes.                |
| \`enhancedInvoices\`     | Helps verify that payments have been made against historic invoices. Great for invoice finance lenders.                                       |

[Learn more](https://docs.codat.io/lending/features/excel-download-overview#feature-components) about valid Excel report types.


`,
  args,
  tool: async (client, args, ctx) => {
    const [result, apiCall] = await excelReportsGenerate(
      client,
      args.request,
      { fetchOptions: { signal: ctx.signal } },
    ).$inspect();

    if (!result.ok) {
      return {
        content: [{ type: "text", text: result.error.message }],
        isError: true,
      };
    }

    const value = result.value;

    return formatResult(value, apiCall);
  },
};
